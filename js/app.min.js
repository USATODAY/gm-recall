$(document).ready(function(){function initCarIso(){var $container=$("#car-iso");$container.isotope({itemSelector:".small-tile",layoutMode:"fitRows",getSortData:{category:"[data-category]",model:"[data-name]",year:".year",problem:"[data-problem]",recallDate:"[data-date]",population:".population parseInt"},sortBy:"recallDate"});var filters={};$("#filters").on("click","li",function(){var $this=$(this),$buttonGroup=$this.parents("#filter-list2");$buttonGroup.find(".active").removeClass("active"),$this.addClass("active");var filterGroup=$buttonGroup.attr("data-filter-group");filters[filterGroup]=$this.attr("data-filter");var currentGroup,currentFilter=$this.attr("data-filter");currentFilter||(currentGroup="total"),currentFilter&&(currentGroup=currentFilter.substring(1).toLowerCase());var $peopleNumber=$("#people-number");$peopleNumber.removeClass(),$peopleNumber.addClass(currentGroup.toUpperCase()),$peopleNumber.html(numberWithCommas(populationData[currentGroup])),console.log(numberWithCommas(populationData[currentGroup]));var filterValue="";for(var prop in filters)filterValue+=filters[prop];$container.isotope({filter:filterValue}),$(".button-group").removeClass("open"),Analytics.click("Data filtered")}),$("#sorts").on("click","li",function(){$("#sorts").find(".active").removeClass("active"),$(this).addClass("active");var sortByValue=$(this).attr("data-sort-by");$container.isotope({sortBy:sortByValue}),$(".button-group").removeClass("open"),Analytics.click("Data sorted")})}function initPeopleIso(){var $container=$("#people-iso");$container.isotope({itemSelector:".people-tile",layoutMode:"fitRows",getSortData:{problem:"[data-problem]"}}),$("#people-number").html(numberWithCommas(populationData.total));var filters={};$("#filters").on("click","li",function(){var $this=$(this),$buttonGroup=$this.parents("#filter-list2");$buttonGroup.find(".active").removeClass("active"),$this.addClass("active");var filterGroup=$buttonGroup.attr("data-filter-group");filters[filterGroup]=$this.attr("data-filter");var filterValue="";for(var prop in filters)filterValue+=filters[prop];$container.isotope({filter:filterValue}),$(".button-group").removeClass("open"),Analytics.click("Data filtered")})}function lookupById(id){var result;return $.each(appData,function(index,value){value.appId==id&&(result=value)}),result}function numberWithCommas(x){if(x){var parts=x.toString().split(".");return parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),parts.join(".")}return""}function addPeople(data){$.each(data,function(key,value){var currentColorIndex;switch(key){case"powertrain":currentColorIndex=0;break;case"ignition":currentColorIndex=1;break;case"electrical":currentColorIndex=2;break;case"restraint":currentColorIndex=3;break;case"interior":currentColorIndex=4}if("total"!=key)for(i=0;i<=value;i+=peopleScale){var person={problem_category:key.toUpperCase(),colorIndex:currentColorIndex},htmlContent=peopleTemplate(person);$("#people-iso").append(htmlContent)}}),initPeopleIso()}function buttonHover(){var currentClass;$("#filter-list").find("li").on("mouseenter",function(){var icon=$(this).find("i");currentClass=icon.attr("class");var newClass=currentClass+"-5";icon.removeClass(currentClass),icon.addClass(newClass)}),$("#filter-list").find("li").on("mouseleave",function(){var icon=$(this).find("i");icon.removeClass(),icon.addClass(currentClass)})}function hideCars(){$("#car-iso").hide(),$("#car-controls").hide(),$("#people-iso").show(),$("#people-controls").show(),$("#people-iso").isotope("layout")}function hidePeople(){$("#people-iso").hide(),$("#car-iso").show(),$("#car-controls").show(),$("#car-iso").isotope("layout")}var peopleScale=1e5,smallTemplateSource=$("#small-template").html(),smallTemplate=Handlebars.compile(smallTemplateSource),popupTemplateSource=$("#popup-template").html(),popupTemplate=Handlebars.compile(popupTemplateSource),peopleTemplateSource=$("#people-tile-template").html(),peopleTemplate=Handlebars.compile(peopleTemplateSource);Handlebars.registerHelper("numberWithCommas",function(x){if(x){var parts=x.toString().split(".");return parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),parts.join(".")}return""});var appData=[],populationData={powertrain:0,ignition:0,electrical:0,restraint:0,interior:0,total:0};$.getJSON("js/gmdata_082714.json",function(data){appData=data,$.each(appData,function(index,value){switch(value.problem_category){case"POWERTRAIN":value.colorIndex=0;break;case"IGNITION":value.colorIndex=1;break;case"ELECTRICAL":value.colorIndex=2;break;case"RESTRAINT":value.colorIndex=3;break;case"INTERIOR":value.colorIndex=4}value.appId="item"+(index+1);var itemMarkup=smallTemplate(value);$("#car-iso").append(itemMarkup)}),initCarIso(),$("#modal-close").on("click",function(){$("body").removeClass("modal-active"),$("#modal-fade").removeClass("fade-in")}),$(".small-tile").on("click",function(){var id=$(this)[0].id,carData=lookupById(id),popUpContent=popupTemplate(carData);$modalContent=$(".modal").find("#modal-content"),$modalContent.empty(),$modalContent.removeClass(),$modalContent.html(popUpContent),$modalContent.addClass(carData.problem_category),$("body").addClass("modal-active"),$("#modal-fade").addClass("fade-in"),Analytics.click("Car details clicked")})}),$.getJSON("js/orig_data.json",function(data){$.each(data,function(index,value){switch(populationData.total+=value.EXPORTS,value.problem_category){case"POWERTRAIN":populationData.powertrain+=value.EXPORTS;break;case"IGNITION":populationData.ignition+=value.EXPORTS;break;case"ELECTRICAL":populationData.electrical+=value.EXPORTS;break;case"RESTRAINT":populationData.restraint+=value.EXPORTS;break;case"INTERIOR":populationData.interior+=value.EXPORTS}}),addPeople(populationData)}),$("#modal-fade").on("click",function(){var $this=$(this);$this.hasClass("pop-fade")?($("body").removeClass("pop-modal-active"),$("#modal-fade").removeClass("fade-in pop-fade")):($("body").removeClass("modal-active"),$("#modal-fade").removeClass("fade-in"))}),buttonHover(),$(".open-button").on("click",function(){var thisParent=($(this).parent().find(".drop-down"),$(this).parent());thisParent.hasClass("open")?thisParent.removeClass("open"):($(".button-group").removeClass("open"),thisParent.addClass("open"))}),$(document).click(function(){$(".button-group").removeClass("open")}),$(".button-group").on("click",function(){}),$(".toggle-tab").on("click",function(){$this=$(this);$this.find(".current");$this.find(".toggle-item").toggleClass("current"),$this.find(".toggle-item").eq(1).hasClass("current")?hideCars():hidePeople()})});
//# sourceMappingURL=app.min.map